== Readers

Pulsar supports both "Consumers" and "Readers". More can be read in their
https://pulsar.apache.org/docs/en/concepts-clients/#reader-interface[documentation]

== Creating readers

To initialize a reader, declare a field annotated with `@PulsarReader` inside any bean or as a constructor argument.

snippet::example.ReaderExample[project-base="doc-examples/example", indent="0"]
<1> Reader annotation with the topic and the reader name
<2> Reader must be of type api:org.apache.pulsar.client.api.Reader
<3> Using readAsync requires `CompletableFeature` or in Kotlin awaiting is possible
<4> Calling the read will move the cursor to the next message or give null in case there are no more messages

Reader `name` can be autogenerated but `topic` argument must be set. Reader injections cause blocking behaviour as
Reader instances will start creation and wait until Pulsar replies with a successful status. Reader `name` defaults
to field or argument name for injection points or method name for method annotated reader.

=== KeyValue readers

In order to use KeyValue with a reader, reader argument type must be of `org.apache.pulsar.common.schema.KeyValue`.
It is possible then to set attributes in `@PulsarReader` like `keyType` which defines what type of data
serializer will be used to extract key, and `keyEncoding` which defines how will the key be extracted: `INLINE` - key
is part of the message payload or `SEPARATED` - key is stored as a message key.